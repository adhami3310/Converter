{
	"app-id": "io.gitlab.adhami3310.Converter",
	"runtime": "org.gnome.Platform",
	"runtime-version": "43",
	"sdk": "org.gnome.Sdk",
	"sdk-extensions" : [
		"org.freedesktop.Sdk.Extension.rust-stable"
	],
	"command": "converter",
	"finish-args": [
		"--share=ipc",
		"--socket=fallback-x11",
		"--device=dri",
		"--socket=wayland",
		"--talk-name=org.freedesktop.portal.OpenURI"
	],
	"cleanup": [
		"/include",
		"/lib/pkgconfig",
		"/man",
		"/share/doc",
		"/share/gtk-doc",
		"/share/man",
		"/share/pkgconfig",
		"*.la",
		"*.a"
	],
	"build-options": {
		"append-path" : "/usr/lib/sdk/rust-stable/bin",
		"env" : {
			"CARGO_HOME" : "/run/build/converter/cargo"
		}
	},
	"modules": [
		{
			"name": "blueprint-compiler",
			"buildsystem": "meson",
			"sources": [
				{
					"type": "git",
					"url": "https://gitlab.gnome.org/jwestman/blueprint-compiler.git",
					"tag": "v0.4.0",
					"commit": "75a6d95988736ec0471d22ceb07579c0cedac2ad"
				}
			]
		},
		{
			"name": "x265",
			"buildsystem": "simple",
			"build-commands": [
				"cmake source -DCMAKE_INSTALL_PREFIX=/app",
				"make",
				"make install",
				"rm -vf /app/lib/libx265.a",
				"ls /app/lib"
			],
			"sources": [
				{
					"type": "archive",
					"url": "http://anduin.linuxfromscratch.org/BLFS/x265/x265_3.4.tar.gz",
					"sha256": "c2047f23a6b729e5c70280d23223cb61b57bfe4ad4e8f1471eeee2a61d148672"
				}
			]
		},
		{
			"name": "libde265",
			"buildsystem": "simple",
			"build-commands": [
				"./autogen.sh",
				"./configure --prefix=/app --disable-dec265 --disable-sherlock265",
				"make",
				"make install"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/strukturag/libde265.git",
					"commit": "b578ae56eb2eb257e19158282c2af9d552565c1c"
				}
			]
		},
		{
			"name": "python3-docutils",
			"buildsystem": "simple",
			"build-commands": [
				"pip3 install --verbose --exists-action=i --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} \"docutils\" --no-build-isolation"
			],
			"sources": [
				{
					"type": "file",
					"url": "https://files.pythonhosted.org/packages/93/69/e391bd51bc08ed9141ecd899a0ddb61ab6465309f1eb470905c0c8868081/docutils-0.19-py3-none-any.whl",
					"sha256": "5e1de4d849fee02c63b040a4a3fd567f4ab104defd8a5511fbbc24a8a017efbc"
				}
			]
		},
		{
			"name": "gdk-pixbuf",
			"buildsystem": "meson",
			"sources": [
				{
					"type": "git",
					"url": "https://gitlab.gnome.org/GNOME/gdk-pixbuf.git",
					"commit": "da8aa8352adff2836b1aba5f8a291e5b6e27dd1b"
				}
			]
		},
		{
			"name": "librsvg",
			"buildsystem": "simple",
			"build-commands": [
				"./autogen.sh --prefix=/app",
				"make",
				"make install"
			],
			"sources": [
				"cargo-sources.json",
				{
					"type": "git",
					"url": "https://gitlab.gnome.org/GNOME/librsvg.git",
					"commit": "b25889ade2a875ef079f322101c1f2f0804e9dcb"
				}
			],
			"build-options": {
				"env" : {
					"CARGO_HOME" : "/run/build/librsvg/cargo"
				}
			}
		},
		{
			"name": "webp-pixbuf-loader",
			"buildsystem": "meson",
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/aruiz/webp-pixbuf-loader.git",
					"commit": "f91f79c05ff90b41774eda613dc10a2a0d996bc8"
				}
			]
		},
		{
			"name": "libheif",
			"buildsystem": "simple",
			"build-commands": [
				"./configure --prefix=/app",
				"make",
				"make install",
				"/app/bin/gdk-pixbuf-query-loaders > /app/lib/gdk-pixbuf-2.0/2.10.0/loaders.cache"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/strukturag/libheif/releases/download/v1.14.0/libheif-1.14.0.tar.gz",
					"sha256": "9a2b969d827e162fa9eba582ebd0c9f6891f16e426ef608d089b1f24962295b5"
				}
			]
		},
		{
			"name": "liblqr",
			"buildsystem": "autotools",
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/carlobaldassi/liblqr.git",
					"commit": "7b88c05cec2f0e60125e1cfcad18c79721a2b27c"
				}
			]
		},
		{
			"name": "magick",
			"buildsystem": "simple",
			"build-commands": [
				"./configure --prefix=/app --with-heic=yes --with-rsvg=yes",
				"make",
				"make install"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/ImageMagick/ImageMagick.git",
					"commit": "cbfe7265e210932a34d4949a90633a65c3f013b3"
				}
			]
		},
		{
			"name": "converter",
			"builddir": true,
			"buildsystem": "meson",
			"sources": [
				{
					"type": "dir",
					"path": "."
				}
			]
		}
	]
}